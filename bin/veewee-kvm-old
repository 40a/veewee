#!/usr/bin/env ruby

require 'rubygems'
require 'thor'
require 'libvirt'
require 'fog'

require 'veewee'

class VeeweeCLI < Thor

  desc "build [NAME]", "build the box defined"
  method_options :force => :boolean
  def build(box_name)


    logger=ANSI::Logger.new(STDOUT)
    logger.level=Object.const_get('ANSI').const_get('Logger').const_get('DEBUG')
    logger.formatter do |severity, timestamp, progname, msg|
        #  "#{progname}@#{timestamp} - #{severity}::#{msg}"
        "#{msg}\n"
    end
    logger.ansicolor=false


    puts "Building box #{box_name}"
    box=Veewee::Environment.new(options,logger).get_builder(:kvm,options).get_box(box_name,box_name,options)
    box.build(options)

  end

end

VeeweeCLI.start
