#!/usr/bin/env ruby

require 'rubygems'
require 'thor'
require 'bundler'
require 'virtualbox'
require 'veewee'


   
class VeeweeCLI < Thor 
  
  desc "define [NAME] [TEMPLATE]", "initializes a box from a template" 
  method_options :force => :boolean
  def define(box_name=nil, template=nil)
    
    if (box_name.nil?)  
      puts "please provide a box_name"
      exit
    end
    
    puts "Init a new box #{box_name}, starting from template #{template}"
  	Veewee::Environment.define(box_name,template)
  	
  end

  desc "templates", "list the template available" 
  def templates 
    Veewee::Environment.list_templates
  end
  
  desc "build [NAME]", "build the box defined" 
  method_options :force => :boolean
  def build(box_name)
    puts "Building box #{box_name}"
    vs=Veewee::Environment.new(options)
    vd=vs.get_definition(box_name)
    vs.build(box_name,vd)    
  end

  desc "export [NAME]", "export the box" 
  method_options :force => :boolean  
  def export(box_name)
      if (!box_name.nil?)
        Veewee::Environment.export_box(box_name)
      end
  end
  
end



version=VirtualBox.version
if (version.match(/^4./))
   	VeeweeCLI.start
else
   	puts "veewee only supports VirtualBox 4.x"
end
